<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: input-field.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: input-field.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>define([
    './utils',
    './base-form-element'
], function (
    Utils,
    BaseFormElement
) {
    "use strict";

    /**
     * The function that fires when the input value changes
     * @callback InputField~onChange
     * @param {string} value - The new value of the input element
     * @param {HTMLInputElement} input - The input element
     * @param {HTMLElement} UIElement - The container of the input element
     * @param {Event} event - The event
     */

    /**
     * The function that is triggered when the input field has changed after a key has been pressed down
     * NOTE: This function can fire rapidly as a user types!
     * @callback InputField~onKeyDownChange
     * @param {string} value - The new value of the input element
     * @param {HTMLInputElement} input - The input element
     * @param {HTMLElement} UIElement - The container of the input element
     * @param {Event} event - The event
     */

    /**
     * Adds useful logic to an input field.
     * @class InputField
     * @extends BaseFormElement
     * @param {HTMLInputElement} options.el - The input field element
     * @param {InputField~onChange} [options.onChange] - A callback function that fires when the input value changes
     * @param {string} [options.cssPrefix] - A custom css class that will be used as namespace for all css classes applied
     * @param {InputField~onKeyDownChange} [options.onKeyDownChange] - A callback function that fires when input has changed after key down press
     */
    var InputField = function (options) {
        this.initialize(options);
    };

    InputField.prototype = Utils.extend({}, BaseFormElement.prototype, /** @lends InputField */{

        /**
         * Initializes the Input Field class.
         * @param {object} options - Options passed into instance
         */
        initialize: function (options) {

            this.options = Utils.extend({
                el: null,
                onChange: null,
                cssPrefix: 'ui-input-text',
                onKeyDownChange: null
            }, options);

            BaseFormElement.prototype.initialize.call(this, options);

            this.prefix = this.options.cssPrefix;

            this.disabledClass = this.prefix + '-disabled';
            this.activeClass = this.prefix + '-active';
            this.inputClass = this.prefix + '-input';
            this.containerClass = this.prefix;
            this.placeholderClass = this.prefix + '-placeholder';

            this.setup();

        },

        /**
         * Sets up events for showing/hiding tooltip.
         */
        setup: function () {
            var input = this.options.el;

            // add internal class if doesnt already exist
            Utils.addClass(input, this.inputClass);

            this._container = this._buildUIElement(input);
            this._inputEl = Utils.getElementsByClassName(this.inputClass, this._container)[0];

            this.origInputValue = input.value;
            this.isInitDisabled = input.disabled;


            // handle disabled state
            if (this.isInitDisabled) {
                Utils.addClass(this._container, this.disabledClass);
            }

            this._bindEvents();

            // setup placeholder text
            if (!this.origInputValue) {
                this.showPlaceholder();
            }

        },

        /**
         * Sets up events.
         * @private
         */
        _bindEvents: function () {
            var input = this.getFormElement();
            Utils.addEventListener(input, 'focus', '_onInputFocus', this);
            Utils.addEventListener(input, 'blur', '_onInputBlur', this);
            Utils.addEventListener(input, 'change', '_onInputValueChange', this);
            Utils.addEventListener(input, 'keydown', '_onInputKeyDown', this);
        },

        /**
         * Destroys events.
         * @private
         */
        _unbindEvents: function () {
            var input = this.getFormElement();
            Utils.removeEventListener(input, 'focus', '_onInputFocus', this);
            Utils.removeEventListener(input, 'blur', '_onInputBlur', this);
            Utils.removeEventListener(input, 'change', '_onInputValueChange', this);
            Utils.removeEventListener(input, 'keydown', '_onInputKeyDown', this);
        },

        /**
         * When a key is pressed down while inside the input field.
         * @param {Event} e
         * @private
         */
        _onInputKeyDown: function (e) {
            if (this.keyDownTimeoutId) {
                clearTimeout(this.keyDownTimeoutId);
            }
            // to ensure we have the most up-to-date the input field value,
            // we must defer the update evaluation until after 1 millisecond
            this.keyDownTimeoutId = setTimeout(this._triggerKeyDownChange.bind(this, e), 1);
        },

        /**
         * Triggers a change event.
         * @param e
         * @private
         */
        _triggerKeyDownChange: function (e) {
            if (this.options.onKeyDownChange) {
                this.options.onKeyDownChange(this.getValue(), this.getFormElement(), this.getUIElement(), e);
            }
        },

        /**
         * Checks whether placeholder attribute are supported by the browser.
         * @returns {boolean} Returns true if browser supports it
         */
        isPlaceholderSupported: function () {
            var version = Utils.getIEVersion();
            return !version || (version !== 8 && version !== 9);
        },

        /**
         * Shows placeholder text.
         */
        showPlaceholder: function () {
            if (!this.isPlaceholderSupported()) {
                this.getFormElement().value = this.getPlaceholder();
                Utils.addClass(this.getUIElement(), this.placeholderClass);
            }
        },

        /**
         * Sets the value of the input field.
         * @param {string} value - The new input field value
         */
        setValue: function (value) {
            var input = this.getFormElement(),
                currentVal = input.value;
            if (value !== currentVal && value !== this.getPlaceholder()) {
                this.getFormElement().value = value;
                this._triggerChange();
            }
        },

        /**
         * Gets the current input field value.
         * @returns {string} Returns current value
         */
        getValue: function () {
            return this.getFormElement().value;
        },

        /**
         * Clears placeholder text.
         */
        clearPlaceholder: function () {
            if (!this.isPlaceholderSupported()) {
                this.getFormElement().value = '';
                Utils.removeClass(this.getUIElement(), this.placeholderClass);
            }
        },

        /**
         * Builds the UI-friendly version of input field by wrapping it inside of a container.
         * @param {HTMLInputElement} inputEl - The input element
         * @returns {HTMLElement} Returns the input element wrapped in its container
         * @private
         */
        _buildUIElement: function (inputEl) {
            return Utils.wrapHtmlElement(inputEl, '&lt;div class="' + this.containerClass + '">&lt;/div>');
        },

        /**
         * Gets the current placeholder text.
         * @returns {string}
         */
        getPlaceholder: function () {
            var value = this.getFormElement().getAttribute('placeholder');
            // silly IE returns "null" for inputs that dont have a placeholder attribute
            if (value === null) {
                value = '';
            }
            return value;
        },

        /**
         * When the input gains focus.
         * @private
         */
        _onInputFocus: function () {
            if (this.getValue() === this.getPlaceholder()) {
                this.clearPlaceholder();
            }
            Utils.addClass(this.getUIElement(), this.activeClass);
        },

        /**
         * When the input loses focus.
         * @private
         */
        _onInputBlur: function () {
            if (!this.getValue()) {
                this.showPlaceholder();
            }
            Utils.removeClass(this.getUIElement(), this.activeClass);
        },

        /**
         * Triggers a value change.
         * @private
         */
        _triggerChange: function (e) {
            var args = [this.getValue(), this.getFormElement(), this.getUIElement()];
            if (e) {
                args.push(e);
            }
            if (this.options.onChange) {
                this.options.onChange.apply(this, args);
            }
        },

        /**
         * When the input value changes.
         * @param {Event} e - The event that was triggered
         * @private
         */
        _onInputValueChange: function (e) {
            this._triggerChange(e);
        },

        /**
         * Gets the input field element.
         * @returns {HTMLInputElement} Returns the input field element
         */
        getFormElement: function () {
            return this._inputEl;
        },

        /**
         * Gets the input field div element.
         * @returns {HTMLElement} Returns the checkbox div element.
         */
        getUIElement: function () {
            return this._container;
        },

        /**
         * Enables the button toggle.
         */
        enable: function () {
            this.getFormElement().removeAttribute('disabled');
            Utils.removeClass(this.getUIElement(), this.disabledClass);
        },

        /**
         * Disables the button toggle.
         */
        disable: function () {
            this.getFormElement().setAttribute('disabled', 'true');
            Utils.addClass(this.getUIElement(), this.disabledClass);
        },

        /**
         * Gets the unique identifier for input fields.
         * @returns {string}
         */
        getElementKey: function () {
            return 'inputText';
        },

        /**
         * Destruction of this class.
         */
        destroy: function () {
            var container = this.getUIElement(),
                input = this.getFormElement();

            this._unbindEvents();

            container.parentNode.replaceChild(input, container);

            if (this.isInitDisabled) {
                input.setAttribute('disabled', 'true');
            }
            // set original value back
            this.setValue(this.origInputValue);

            BaseFormElement.prototype.destroy.call(this);
        }

    });

    return InputField;
});</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="BaseFormElement.html">BaseFormElement</a></li><li><a href="ButtonToggle.html">ButtonToggle</a></li><li><a href="Checkbox.html">Checkbox</a></li><li><a href="Form.html">Form</a></li><li><a href="InputField.html">InputField</a></li></ul><h3>Namespaces</h3><ul><li><a href="Utils.html">Utils</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a> on Sun Nov 02 2014 15:55:22 GMT-0500 (EST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
